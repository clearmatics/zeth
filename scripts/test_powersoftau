#!/usr/bin/env bash

POT=$1
[ "" == "${POT}" ] && POT="build/src/powersoftau"

POT_DATA="testdata/powersoftau_response.4.bin"
POT_DATA_DEGREE=16

set -e
set -x

# Verify real data
${POT} --verify ${POT_DATA} ${POT_DATA_DEGREE}

# Write dummy data
${POT} --dummy /tmp/test_pot-6.bin 64

# Verify dummy data
${POT} --verify /tmp/test_pot-6.bin 64

# Generate encoded Lagrange evaluation from real data
${POT} --out /tmp/lagrange-4.bin ${POT_DATA} ${POT_DATA_DEGREE}

# Generate encoded evaluation of Lagrange polynomials of smaller
# degree, from real data
${POT} \
    --out /tmp/lagrange-3.bin \
    --lagrange-degree $((${POT_DATA_DEGREE} / 2)) \
    ${POT_DATA} ${POT_DATA_DEGREE}

set +x
echo "=================================================================="
echo "==                            PASSED                            =="
echo "=================================================================="
