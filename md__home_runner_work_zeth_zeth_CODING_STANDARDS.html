<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zeth - Zerocash on Ethereum: Coding Standards</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Zeth - Zerocash on Ethereum
   &#160;<span id="projectnumber">0.8</span>
   </div>
   <div id="projectbrief">Reference implementation of the Zeth protocol by Clearmatics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Coding Standards </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>As far as possible, we try to use tools to ensure a consistent style in all languages, and strive to run these tools as CI jobs. New code should follow these rules, and old code should be changed over time to satisfy them.</p>
<h1>All Languages</h1>
<ul>
<li>Each file should have a well-defined purpose and be concerned with a single narrow concept.</li>
<li>Add unit tests for new code. As far as possible, one test per source file or logical group of files.</li>
<li>Names should be as clear and concise as possible, avoiding opaque abbreviations.</li>
<li><p class="startli">In conditions, the tested variable must appear on the left of the operator. This is to stay consistent with English, which writes/reads from left to right. </p><div class="fragment"><div class="line">// GOOD:</div>
<div class="line">// The test below reads &quot;If age is above 18&quot;</div>
<div class="line">// (the test is on the value of `age` here, so it appears first)</div>
<div class="line">if (age &gt;= 18) {</div>
<div class="line">    drive();</div>
<div class="line">}</div>
</div><!-- fragment --><p class="startli">instead of: </p><div class="fragment"><div class="line">// BAD:</div>
<div class="line">// The test below reads &quot;If 18 is below age&quot;</div>
<div class="line">// (the test is on the value `age` yet it appears last, which doesn&#39;t read naturally)</div>
<div class="line">if (18 &lt;= age) {</div>
<div class="line">    drive();</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Executables (bash scripts, CLIs etc.) and their flags are named using <code>kebab-case</code> (e.g. <code>foo-bar --baz</code>).</li>
</ul>
<h1>Bash</h1>
<p>Only executable bash scripts must be set to be executable (e.g. via <code>chmod +x &lt;file&gt;</code>). Executable bash scripts are named using <code>kebab-case</code> and do not have file extension (e.g. <code>my-bash-command</code> and <b>not</b> <code>my-bash-command.sh</code> or <code>my_bash_command</code>). Non-executable bash scripts are named in <code>snake_case</code> and have an <code>.sh</code> extension. Use the <code>env</code> functionality by default in shebangs except if the context suggests otherwise (e.g. <code>#!/usr/bin/env bash</code> instead of <code>#!/bin/bash</code>).</p>
<h1>Python</h1>
<p>We adhere to the <code>pep8</code> standard, using <code>flake8</code>, <code>pylint</code> and <code>mypy</code> to catch further programming errors or standard violations. Type hints must be used everywhere.</p>
<h1>Solidity</h1>
<p>Solidity code must adhere to the <a href="https://docs.soliditylang.org/en/develop/style-guide.html">solidity coding standards</a>, with the following amendments:</p><ul>
<li>Test functions must have a <code>test</code> prefix (e.g. <code>testReverseBytes</code>)</li>
<li>Private/internal state variables and functions must have an underscore prefix (e.g. <code>_myInternalFunction</code>)</li>
<li>The order in which contract members are written must driven by their scope (i.e. <code>public/external</code> functions must appear first in the contract code, <code>internal/private</code> functions must appear last). Additionally, <code>virtual</code> functions in abstract contracts must be written last in their visibility group.</li>
<li>Function parameters must not be prefixed with an underscore</li>
<li>Interface names must have a capital I prefix (e.g. <code>IERC20</code>)</li>
<li>Library names must have a <code>Lib</code> prefix (e.g. <code>LibPairing</code>)</li>
<li>Test contract names must have a <code>Test</code> prefix (e.g. <code>TestMyContract</code>)</li>
<li>Abstract contract names must have an <code>Abstract</code> prefix (e.g. <code>AbstractMyContract</code>)</li>
<li>Contract names may not be PascalCase if using PascalCase is introducing confusions in the name (e.g. <code>BLS12377.sol</code> vs <code>BLS12_377.sol</code>). PascalCase should be used whenever possible</li>
<li>Event names must be prefixed by <code>Log</code> (e.g. <code>LogDeposit</code>)</li>
</ul>
<p><b>Note:</b> Some of the files of the current code base may not fully comply with the coding standards above. Old code will progressively be updated to converge towards the recommended style.</p>
<h1>C++</h1>
<p>The <a href="./.clang-format">.clang-format</a> file describes the C++ code formatting used in the project. The script </p><div class="fragment"><div class="line">$ scripts/format</div>
</div><!-- fragment --><p>can be run from the repository root to format all files. The CI builds will fail if formatting issues are found.</p>
<p>As well as the above formatting, the following conventions are also used in the C++ code:</p>
<h2>Formatting</h2>
<ul>
<li>Long comments at the end of lines cause unnecessary line breaks. Comment above the line (do not add empty line between the comment and the line).</li>
<li>Multi-line comments should use <code>//</code> style (clang-format does not cope well with other styles). <div class="fragment"><div class="line">// Your comment here line 1</div>
<div class="line">// line 2</div>
</div><!-- fragment --></li>
<li><p class="startli">Do not omit braces for single-line statements in <code>if</code>, <code>for</code>, <code>while</code>, etc clauses. (Note that clang-format does not enforce this). </p><div class="fragment"><div class="line">// GOOD:</div>
<div class="line">if (condition) {</div>
<div class="line">    x = 0;</div>
<div class="line">} else {</div>
<div class="line">    x = 1;</div>
<div class="line">}</div>
</div><!-- fragment --><p class="startli">instead of: </p><div class="fragment"><div class="line">// BAD:</div>
<div class="line">if (condition)</div>
<div class="line">    x = 0;</div>
<div class="line">else</div>
<div class="line">    x = 1;</div>
</div><!-- fragment --></li>
<li><code>//</code> can be used at the end of a line in an initializer to retain formatting: <div class="fragment"><div class="line">libsnark::pb_variable_array&lt;FieldT&gt; value = from_bits(</div>
<div class="line">    {</div>
<div class="line">        0, 0, 1, 0, 1, 1, 1, 1, //    &lt;--- these breaks will remain</div>
<div class="line">        0, 0, 0, 0, 0, 0, 0, 0, //</div>
<div class="line">        0, 0, 0, 0, 0, 0, 0, 0, //</div>
<div class="line">        0, 0, 0, 0, 0, 0, 0, 0, //</div>
<div class="line">        ...</div>
</div><!-- fragment --></li>
<li>Do not leave whitespace at the end of lines</li>
<li>Documentation comments should use the <code>///</code> style, and should be present in the include files ONLY.</li>
</ul>
<h2>Naming and ordering conventions</h2>
<ul>
<li>Variables, functions and concrete types (including classes and type aliases) use <code>snake_case_names</code>.</li>
<li>Macros are <code>ALL_CAPS</code>.</li>
<li>Functions operating on some type <code>my_type</code> should be named <code>my_type_operation</code>, where the <code>my_type</code> argument appears first.</li>
<li>Type parameters are <a href="https://docs.microsoft.com/en-us/archive/blogs/brada/history-around-pascal-casing-and-camel-casing">PascalCase or camelCase</a> with a trailing <code>T</code> (e.g. <code>MyTypeT</code> or <code>myTypeT</code>)</li>
<li>Each source file should be concerned with a single "concept" (often single class or type + methods)</li>
<li>Encodings are named:<ul>
<li><code>json</code></li>
<li><code>hex</code></li>
<li><code>bytes</code></li>
<li><code>string</code> (human-readable string, if different from hex and json)</li>
<li><code>proto</code> (protobuf-defined objects) Note that <code>hex</code> implicitly means a string type. <code>json</code> refers to strings which contain "whole" json objects, e.g. <code>1234</code>, <code>"string"</code>, <code>["array", "of, "strings"]&lt;/tt&gt; or &lt;tt&gt;{"an": "object", "with": "attributes"}</code>.</li>
</ul>
</li>
<li>Encoding methods are named <code>to_&lt;encoding&gt;()</code> and static parsing methods are named <code>from_&lt;encoding&gt;</code> (e.g. <code>to_json</code> or <code>from_proto</code>).</li>
<li>Reading from and writing to streams is performed by methods <code>std::istream &amp;read_&lt;encoding&gt;(std::istream &amp;)</code> and <code>std::ostream &amp;write_&lt;encoding&gt;(std::ostream &amp;)</code> (e.g. <code>write_json</code> or <code>read_bytes</code>).</li>
<li>Similarly, encoding, parsing, reading and writing functions are named <code>&lt;type&gt;_to_&lt;encoding&gt;</code>, <code>&lt;type&gt;_from_&lt;encoding&gt;</code>, <code>&lt;type&gt;_read_&lt;encoding&gt;</code> and <code>&lt;type&gt;_write_&lt;encoding&gt;</code> (e.g. <code>point_g1_affine_to_json</code>, <code>point_g1_affine_from_proto</code>).</li>
<li>Conversion between encodings (where there is no high-level type) are named <code>&lt;source&gt;_to_&lt;dest&gt;</code> (e.g. <code>hex_to_bytes</code>).</li>
</ul>
<h2>Other</h2>
<ul>
<li>Avoid <code>auto</code> except when strictly necessary.</li>
<li>Use <code>const</code> (including for local variables) where possible.</li>
<li>Implement streaming and/or encoding methods based on what is sensible for the underlying type. There is no need for all types to be serializable to all encodings if the rest of the code does not use them.</li>
<li>In general, pass inputs by (const) reference, and return by value. Implement sensible move operators. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 28 2022 10:29:03 for Zeth - Zerocash on Ethereum by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
