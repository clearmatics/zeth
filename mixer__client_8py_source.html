<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zeth - Zerocash on Ethereum: /home/runner/work/zeth/zeth/client/zeth/core/mixer_client.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Zeth - Zerocash on Ethereum
   &#160;<span id="projectnumber">0.8</span>
   </div>
   <div id="projectbrief">Reference implementation of the Zeth protocol by Clearmatics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_db3a54907829b36871118d03417739cd.html">client</a></li><li class="navelem"><a class="el" href="dir_b942c039252f9e8f95ae28c6b9e8d53a.html">zeth</a></li><li class="navelem"><a class="el" href="dir_38ce334a06daf3188963366b3e0a8cf4.html">core</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mixer_client.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mixer__client_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html">    1</a></span>&#160;<span class="comment">#!/usr/bin/env python3</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"># Copyright (c) 2015-2022 Clearmatics Technologies Ltd</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"># SPDX-License-Identifier: LGPL-3.0+</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">from</span> __future__ <span class="keyword">import</span> annotations</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core.html">zeth.core</a> <span class="keyword">import</span> contracts</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core.html">zeth.core</a> <span class="keyword">import</span> constants</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core_1_1zeth__address.html">zeth.core.zeth_address</a> <span class="keyword">import</span> ZethAddressPub, ZethAddress</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core_1_1ownership.html">zeth.core.ownership</a> <span class="keyword">import</span> OwnershipPublicKey, OwnershipSecretKey, \</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    OwnershipKeyPair, ownership_key_as_hex</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core_1_1encryption.html">zeth.core.encryption</a> <span class="keyword">import</span> \</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    EncryptionPublicKey, EncryptionSecretKey, InvalidSignature, \</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    generate_encryption_keypair, encrypt, decrypt</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core_1_1merkle__tree.html">zeth.core.merkle_tree</a> <span class="keyword">import</span> MerkleTree, compute_merkle_path</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core_1_1pairing.html">zeth.core.pairing</a> <span class="keyword">import</span> PairingParameters</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core.html">zeth.core</a> <span class="keyword">import</span> signing</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core.html">zeth.core</a> <span class="keyword">import</span> proto_utils</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core_1_1zksnark.html">zeth.core.zksnark</a> <span class="keyword">import</span> IZKSnarkProvider, get_zksnark_provider, \</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    ExtendedProof</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core_1_1utils.html">zeth.core.utils</a> <span class="keyword">import</span> EtherValue, digest_to_binary_string, \</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    int64_to_hex, message_to_bytes, eth_address_to_bytes32, to_zeth_units, \</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    get_contracts_dir, hex_to_uint256_list</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacezeth_1_1core_1_1prover__client.html">zeth.core.prover_client</a> <span class="keyword">import</span> ProverConfiguration, ProverClient</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">import</span> zeth.api.zeth_messages_pb2 <span class="keyword">as</span> api</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">import</span> os</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">import</span> json</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">import</span> math</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">from</span> hashlib <span class="keyword">import</span> blake2s, sha256</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">import</span> traceback</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">import</span> eth_abi</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">from</span> typing <span class="keyword">import</span> Tuple, Dict, List, Iterator, Callable, Optional, Any</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a9196c572190bbccc43e282463a8b53f8">   38</a></span>&#160;ZERO_UNITS_HEX = <span class="stringliteral">&quot;0000000000000000&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a7eda683c0a627e0201fde172446bac9c">   39</a></span>&#160;ZERO_ADDRESS = <span class="stringliteral">&quot;0x0000000000000000000000000000000000000000&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"># JoinSplit Signature Keys definitions</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a5b640fdd5f12ebce4e8675092a94feba">   42</a></span>&#160;JoinsplitSigVerificationKey = <a class="code" href="classzeth_1_1core_1_1signing_1_1SigningVerificationKey.html">signing.SigningVerificationKey</a></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a073b0a4501c177e8f8bd278cf3aebc05">   43</a></span>&#160;JoinsplitSigSecretKey = <a class="code" href="classzeth_1_1core_1_1signing_1_1SigningSecretKey.html">signing.SigningSecretKey</a></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a46e38461757ad3e21a2723ccd461d371">   44</a></span>&#160;JoinsplitSigKeyPair = <a class="code" href="classzeth_1_1core_1_1signing_1_1SigningKeyPair.html">signing.SigningKeyPair</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a83a47832e6ae8f3d0b5711a5ff0bbbaf">   46</a></span>&#160;ComputeHSigCB = Callable[[List[bytes], JoinsplitSigVerificationKey], bytes]</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html">   49</a></span>&#160;<span class="keyword">class </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html">MixCallDescription</a>:</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="stringliteral">    High-level description of a call to the mixer contract. Holds information</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="stringliteral">    used when generating the ProofInputs, ZK-proof and final MixParameters</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="stringliteral">    object.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a4a34c9c2906d533496c64fa038ab352c">   55</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a4a34c9c2906d533496c64fa038ab352c">__init__</a>(</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            self,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            mk_tree: MerkleTree,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            sender_ownership_keypair: OwnershipKeyPair,</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a32107594c4f7240435bb47a65b177898">   59</a></span>&#160;            inputs: List[Tuple[int, api.ZethNote]],</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#af2371c1cb4b0d0af7831baccd3e030d4">   60</a></span>&#160;            outputs: List[Tuple[ZethAddressPub, EtherValue]],</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#ae72b7983fce559b439432fde63ecaa36">   61</a></span>&#160;            v_in: EtherValue,</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a7e8968f1e53381abc40a16cc637e931b">   62</a></span>&#160;            v_out: EtherValue,</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a372ecca420e2d33692393900a96d7910">   63</a></span>&#160;            compute_h_sig_cb: Optional[ComputeHSigCB] = <span class="keywordtype">None</span>):</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keyword">assert</span> len(inputs) &lt;= constants.JS_INPUTS</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keyword">assert</span> len(outputs) &lt;= constants.JS_OUTPUTS</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a32107594c4f7240435bb47a65b177898">mk_tree</a> = mk_tree</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#af2371c1cb4b0d0af7831baccd3e030d4">sender_ownership_keypair</a> = sender_ownership_keypair</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#ae72b7983fce559b439432fde63ecaa36">v_in</a> = v_in</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a7e8968f1e53381abc40a16cc637e931b">v_out</a> = v_out</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a372ecca420e2d33692393900a96d7910">compute_h_sig_cb</a> = compute_h_sig_cb</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a97a1c59a2e7dc4701e40d1522b432d2d">   72</a></span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment"># Perform some cleaning and minimal pre-processing of the data. Compute</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment"># and store data that is not derivable from the ProverInput or Proof</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment"># structs (such as the encryption keys for receivers), making it</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="comment"># available to MixerClient calls.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment"># Expand inputs with dummy entries and compute merkle paths.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        sender_a_pk = sender_ownership_keypair.a_pk</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a97a1c59a2e7dc4701e40d1522b432d2d">inputs</a> = \</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a00a0f359681f4860e40b2b95ed4dced6">   81</a></span>&#160;            inputs + \</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            [<a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a90d67dc420cbfb8d34face1628ff3947">get_dummy_input_and_address</a>(sender_a_pk)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;             <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(constants.JS_INPUTS - len(inputs))]</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment"># Pad the list of outputs if necessary</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">if</span> len(outputs) &lt; constants.JS_OUTPUTS:</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            dummy_k_pk = <a class="code" href="namespacezeth_1_1core_1_1encryption.html#a68eb763a92c1093dd74c6076d4c7095a">generate_encryption_keypair</a>().k_pk</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            dummy_addr_pk = <a class="code" href="classzeth_1_1core_1_1zeth__address_1_1ZethAddressPub.html">ZethAddressPub</a>(sender_a_pk, dummy_k_pk)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a00a0f359681f4860e40b2b95ed4dced6">outputs</a> = \</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                outputs + \</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                [(dummy_addr_pk, <a class="code" href="classzeth_1_1core_1_1utils_1_1EtherValue.html">EtherValue</a>(0))</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(constants.JS_OUTPUTS - len(outputs))]</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a00a0f359681f4860e40b2b95ed4dced6">outputs</a> = outputs</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html">   97</a></span>&#160;<span class="keyword">class </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html">MixParameters</a>:</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">    All data required to call the mixer, with no further processing required</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">    (except creation of a transaction). This is the result of fully processing</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral">    a MixCallDescription, generating appropriate secret data and ZK-proof and</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral">    signing the result.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#ab85bfcc6e82953d3fb8dd286db6ad495">  104</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#ab85bfcc6e82953d3fb8dd286db6ad495">__init__</a>(</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6bde18cd240f8a1e65248ecad0ce5e79">  105</a></span>&#160;            self,</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#acf3384931a1657d7487840a73621d657">  106</a></span>&#160;            extended_proof: ExtendedProof,</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#ad6a1c4d81bcac12afe4110bfcb97b62f">  107</a></span>&#160;            public_data: List[int],</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a5526cd2d9f1b047d336d8b31592707d6">  108</a></span>&#160;            signature_vk: <a class="code" href="classzeth_1_1core_1_1signing_1_1SigningVerificationKey.html">signing.SigningVerificationKey</a>,</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a9e23a5a843fee3c7d1c20f903e109c42">  109</a></span>&#160;            signature: signing.Signature,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            ciphertexts: List[bytes]):</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6bde18cd240f8a1e65248ecad0ce5e79">extended_proof</a> = extended_proof</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#acf3384931a1657d7487840a73621d657">public_data</a> = public_data</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#ad6a1c4d81bcac12afe4110bfcb97b62f">signature_vk</a> = signature_vk</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a5526cd2d9f1b047d336d8b31592707d6">signature</a> = signature</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a9e23a5a843fee3c7d1c20f903e109c42">ciphertexts</a> = ciphertexts</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    @staticmethod</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6f81d7f4facbba021edd0fc46163e823">  118</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6f81d7f4facbba021edd0fc46163e823">from_json</a>(zksnark: IZKSnarkProvider, params_json: str) -&gt; MixParameters:</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">return</span> MixParameters.from_json_dict(zksnark, json.loads(params_json))</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a8bc3537d0f9ff59421006b7ac90a1aeb">  121</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a8bc3537d0f9ff59421006b7ac90a1aeb">to_json</a>(self) -&gt; str:</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">return</span> json.dumps(self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6596fd9fdc9ad21b0e9b605e2084091e">to_json_dict</a>())</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6596fd9fdc9ad21b0e9b605e2084091e">  124</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6596fd9fdc9ad21b0e9b605e2084091e">to_json_dict</a>(self) -&gt; Dict[str, Any]:</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        ext_proof_json = self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6bde18cd240f8a1e65248ecad0ce5e79">extended_proof</a>.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6596fd9fdc9ad21b0e9b605e2084091e">to_json_dict</a>()</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        public_data = [hex(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#acf3384931a1657d7487840a73621d657">public_data</a>]</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        signature_vk_json = [</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <a class="code" href="namespacetest__commands_1_1mock.html#a443e35cc54edb3a7e6f1bca433ea6234">str</a>(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            signing.verification_key_as_mix_parameter(self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#ad6a1c4d81bcac12afe4110bfcb97b62f">signature_vk</a>)]</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        signature_json = <a class="code" href="namespacetest__commands_1_1mock.html#a443e35cc54edb3a7e6f1bca433ea6234">str</a>(signing.signature_as_mix_parameter(self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a5526cd2d9f1b047d336d8b31592707d6">signature</a>))</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        ciphertexts_json = [x.hex() <span class="keywordflow">for</span> x <span class="keywordflow">in</span> self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a9e23a5a843fee3c7d1c20f903e109c42">ciphertexts</a>]</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">return</span> {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="stringliteral">&quot;extended_proof&quot;</span>: ext_proof_json,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="stringliteral">&quot;public_data&quot;</span>: public_data,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="stringliteral">&quot;signature_vk&quot;</span>: signature_vk_json,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="stringliteral">&quot;signature&quot;</span>: signature_json,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="stringliteral">&quot;ciphertexts&quot;</span>: ciphertexts_json,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    @staticmethod</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#af990c0097315a2560d4cb9f50dc3384a">  141</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#af990c0097315a2560d4cb9f50dc3384a">from_json_dict</a>(</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            zksnark: IZKSnarkProvider,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            json_dict: Dict[str, Any]) -&gt; MixParameters:</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        ext_proof = ExtendedProof.from_json_dict(</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            zksnark, json_dict[<span class="stringliteral">&quot;extended_proof&quot;</span>])</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        public_data = [<a class="code" href="namespacezeth_1_1cli_1_1zeth__deploy.html#ad2926a6c26d05cc927c0197ad0e9c241">int</a>(x, 16) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> json_dict[<span class="stringliteral">&quot;public_data&quot;</span>]]</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        signature_pk_param = [<a class="code" href="namespacezeth_1_1cli_1_1zeth__deploy.html#ad2926a6c26d05cc927c0197ad0e9c241">int</a>(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> json_dict[<span class="stringliteral">&quot;signature_vk&quot;</span>]]</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        signature_pk = signing.verification_key_from_mix_parameter(</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            signature_pk_param)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        signature = signing.signature_from_mix_parameter(</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <a class="code" href="namespacezeth_1_1cli_1_1zeth__deploy.html#ad2926a6c26d05cc927c0197ad0e9c241">int</a>(json_dict[<span class="stringliteral">&quot;signature&quot;</span>]))</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        ciphertexts = [bytes.fromhex(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> json_dict[<span class="stringliteral">&quot;ciphertexts&quot;</span>]]</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html">MixParameters</a>(</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            ext_proof, public_data, signature_pk, signature, ciphertexts)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a841cba7311224ca107fac11867550484">  157</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a841cba7311224ca107fac11867550484">mix_parameters_to_contract_arguments</a>(</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        zksnark: IZKSnarkProvider,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        pp: PairingParameters,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        mix_parameters: MixParameters) -&gt; List[Any]:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="stringliteral">    Convert MixParameters to a list of eth ABI objects which can be passed to</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="stringliteral">    the contract&#39;s mix method.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    proof_contract_params = zksnark.proof_to_contract_parameters(</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        mix_parameters.extended_proof.proof, pp)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> [</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        proof_contract_params,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        signing.verification_key_as_mix_parameter(mix_parameters.signature_vk),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        signing.signature_as_mix_parameter(mix_parameters.signature),</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        mix_parameters.public_data,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        mix_parameters.ciphertexts,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    ]</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a6067ad5fa32f5e98e09795a605b8567a">  176</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a6067ad5fa32f5e98e09795a605b8567a">mix_parameters_to_dispatch_parameters</a>(mix_parameters: MixParameters) -&gt; bytes:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="stringliteral">    Encode parameters from mix_parameters into an array of uint256 values,</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="stringliteral">    compatible with the `dispatch` method on Mixer. This conforms to the</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="stringliteral">    `IZecaleApplication` solidity interface of Zecale</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="stringliteral">    (https://github.com/clearmatics/zecale)</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    vk_param = signing.verification_key_as_mix_parameter(</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        mix_parameters.signature_vk)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    sigma_param = signing.signature_as_mix_parameter(mix_parameters.signature)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    public_data = mix_parameters.public_data</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    ciphertexts = mix_parameters.ciphertexts</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> eth_abi.encode_abi(</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        [<span class="stringliteral">&#39;uint256[4]&#39;</span>, <span class="stringliteral">&#39;uint256&#39;</span>, <span class="stringliteral">&#39;uint256[]&#39;</span>, <span class="stringliteral">&#39;bytes[]&#39;</span>],</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        [vk_param, sigma_param, public_data, ciphertexts])  <span class="comment"># type: ignore</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html">  193</a></span>&#160;<span class="keyword">class </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html">MixOutputEvents</a>:</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="stringliteral">    Event data for a single joinsplit output.  Holds address (in merkle tree),</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="stringliteral">    commitment and ciphertext.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#aa5f41846648c34473febadacaccf010e">  198</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#aa5f41846648c34473febadacaccf010e">__init__</a>(</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#a7c61bc41394303392ff22d469ce7eba8">  199</a></span>&#160;            self, commitment: bytes, ciphertext: bytes):</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#aa5834603a498aa7a0b6897e7153317a4">  200</a></span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#a7c61bc41394303392ff22d469ce7eba8">commitment</a> = commitment</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#aa5834603a498aa7a0b6897e7153317a4">ciphertext</a> = ciphertext</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html">  204</a></span>&#160;<span class="keyword">class </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html">MixResult</a>:</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="stringliteral">    Data structure representing the result of the mix call.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a66dcf41a23ef1f37779a84f1aedc6a26">  208</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a66dcf41a23ef1f37779a84f1aedc6a26">__init__</a>(</div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a5b0bfcffc4eee6492d02f78a2179b1c8">  209</a></span>&#160;            self,</div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a4b1d7f04cecfd1a0ccec5004ab0aac12">  210</a></span>&#160;            new_merkle_root: bytes,</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#ae02ff1b3bf86799672bd35c43a8d6b09">  211</a></span>&#160;            nullifiers: List[bytes],</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            output_events: List[MixOutputEvents]):</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a5b0bfcffc4eee6492d02f78a2179b1c8">new_merkle_root</a> = new_merkle_root</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a4b1d7f04cecfd1a0ccec5004ab0aac12">nullifiers</a> = nullifiers</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#ae02ff1b3bf86799672bd35c43a8d6b09">output_events</a> = output_events</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a8b35210320c24f22a60c1d56dfeeb5a6">  218</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a8b35210320c24f22a60c1d56dfeeb5a6">event_args_to_mix_result</a>(event_args: Any) -&gt; MixResult:</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    mix_out_args = zip(event_args.commitments, event_args.ciphertexts)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    out_events = [<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html">MixOutputEvents</a>(c, ciph) <span class="keywordflow">for</span> (c, ciph) <span class="keywordflow">in</span> mix_out_args]</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html">MixResult</a>(</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        new_merkle_root=event_args.root,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        nullifiers=event_args.nullifiers,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        output_events=out_events)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#af361cfd7732c85a4cd60c74f7a728589">  227</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#af361cfd7732c85a4cd60c74f7a728589">create_api_joinsplit_input</a>(</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        merkle_path: List[str],</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        address: int,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        note: api.ZethNote,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        a_sk: OwnershipSecretKey,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        nullifier: bytes) -&gt; api.JoinsplitInput:</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">return</span> api.JoinsplitInput(</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        merkle_path=merkle_path,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        address=address,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        note=note,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        spending_ask=<a class="code" href="namespacezeth_1_1core_1_1ownership.html#aebd2761f54eb51471a6f86b41b204801">ownership_key_as_hex</a>(a_sk),</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        nullifier=nullifier.hex())</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a90d67dc420cbfb8d34face1628ff3947">  241</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a90d67dc420cbfb8d34face1628ff3947">get_dummy_input_and_address</a>(</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        a_pk: OwnershipPublicKey) -&gt; Tuple[int, api.ZethNote]:</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="stringliteral">    Create a zeth note and address, for use as circuit inputs where there is no</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="stringliteral">    real input.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    dummy_note = api.ZethNote(</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        apk=<a class="code" href="namespacezeth_1_1core_1_1ownership.html#aebd2761f54eb51471a6f86b41b204801">ownership_key_as_hex</a>(a_pk),</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        value=ZERO_UNITS_HEX,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        rho=_get_dummy_rho(),</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        trap_r=_trap_r_randomness())</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment"># Note that the Merkle path is not fully checked against the root by the</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment"># circuit since the note value is 0. Hence the address used here is</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment"># arbitrary.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    dummy_note_address = 0</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">return</span> (dummy_note_address, dummy_note)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html">  259</a></span>&#160;<span class="keyword">class </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html">MixerClient</a>:</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="stringliteral">    Interface to operations on the Mixer contract.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ac1c98f79caf1029e19eb531ff905be62">  263</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ac1c98f79caf1029e19eb531ff905be62">__init__</a>(</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a5bccd48c118d72389197da2f5696aa16">  264</a></span>&#160;            self,</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ad00338cc15b768c7d9c3ed75fb54ebc6">  265</a></span>&#160;            web3: Any,</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a72aeeee1bf0fc80ed6b206eef2e6ea5f">  266</a></span>&#160;            prover_config: ProverConfiguration,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            mixer_instance: Any):</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a5bccd48c118d72389197da2f5696aa16">web3</a> = web3</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ad00338cc15b768c7d9c3ed75fb54ebc6">prover_config</a> = prover_config</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a72aeeee1bf0fc80ed6b206eef2e6ea5f">mixer_instance</a> = mixer_instance</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    @staticmethod</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a670999b239b06c8a46b55af072990892">  273</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a670999b239b06c8a46b55af072990892">deploy</a>(</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            web3: Any,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            prover_client: ProverClient,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            deployer_eth_address: str,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            deployer_eth_private_key: Optional[bytes],</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            token_address: Optional[str] = <span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            permitted_dispatcher: Optional[str] = <span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            vk_hash: Optional[str] = <span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            deploy_gas: Optional[int] = <span class="keywordtype">None</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    ) -&gt; Tuple[MixerClient, <a class="code" href="classzeth_1_1core_1_1contracts_1_1InstanceDescription.html">contracts.InstanceDescription</a>]:</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="stringliteral">        Deploy Zeth contracts.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        prover_config = prover_client.get_configuration()</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        vk = prover_client.get_verification_key()</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        contracts_dir = <a class="code" href="namespacezeth_1_1core_1_1utils.html#a4dc64205eb36fec046a8a0b491f29ee6">get_contracts_dir</a>()</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        zksnark = <a class="code" href="namespacezeth_1_1core_1_1zksnark.html#ab85434ad85cfc14751f78186a97480bf">get_zksnark_provider</a>(prover_config.zksnark_name)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        pp = prover_config.pairing_parameters</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        mixer_name = zksnark.get_contract_name(pp)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        mixer_src = os.path.join(contracts_dir, mixer_name + <span class="stringliteral">&quot;.sol&quot;</span>)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        vk_hash_evm = list(<a class="code" href="namespacezeth_1_1core_1_1utils.html#a323360466a0b5cf1b349e5f561dfcf8a">hex_to_uint256_list</a>(vk_hash)) <span class="keywordflow">if</span> vk_hash <span class="keywordflow">else</span> [0, 0]</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keyword">assert</span> len(vk_hash_evm) == 2</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment"># Constructor parameters have the form:</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">#   uint256 mk_depth</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">#   address token</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">#   ... snark-specific key data ...</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        constructor_parameters: List[Any] = [</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            constants.ZETH_MERKLE_TREE_DEPTH,  <span class="comment"># mk_depth</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            token_address <span class="keywordflow">or</span> ZERO_ADDRESS,     <span class="comment"># token</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            zksnark.verification_key_to_contract_parameters(vk, pp),  <span class="comment"># vk</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            permitted_dispatcher <span class="keywordflow">or</span> ZERO_ADDRESS,  <span class="comment"># permitted_dispatcher</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            vk_hash_evm  <span class="comment"># vk_hash</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        ]</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        mixer_description = contracts.InstanceDescription.deploy(</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            web3,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            mixer_src,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            mixer_name,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            deployer_eth_address,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            deployer_eth_private_key,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            deploy_gas,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            compiler_flags={},</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            args=constructor_parameters)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        mixer_instance = mixer_description.instantiate(web3)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        client = <a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html">MixerClient</a>(web3, prover_config, mixer_instance)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">return</span> client, mixer_description</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a83463a7864377426e2b7b8a560254696">  321</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a83463a7864377426e2b7b8a560254696">deposit</a>(</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            self,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            prover_client: ProverClient,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            mk_tree: MerkleTree,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            zeth_address: ZethAddress,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            sender_eth_address: str,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            sender_eth_private_key: Optional[bytes],</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            eth_amount: EtherValue,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            outputs: Optional[List[Tuple[ZethAddressPub, EtherValue]]] = <span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            tx_value: Optional[EtherValue] = <span class="keywordtype">None</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    ) -&gt; str:</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> outputs <span class="keywordflow">or</span> len(outputs) == 0:</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            outputs = [(zeth_address.addr_pk, eth_amount)]</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">return</span> self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a3979cd0e3ff9c3c9ebedac2068de92df">joinsplit</a>(</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            prover_client,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            mk_tree,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            sender_ownership_keypair=zeth_address.ownership_keypair(),</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            sender_eth_address=sender_eth_address,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            sender_eth_private_key=sender_eth_private_key,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            inputs=[],</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            outputs=outputs,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            v_in=eth_amount,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            v_out=<a class="code" href="classzeth_1_1core_1_1utils_1_1EtherValue.html">EtherValue</a>(0),</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            tx_value=tx_value)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a3979cd0e3ff9c3c9ebedac2068de92df">  346</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a3979cd0e3ff9c3c9ebedac2068de92df">joinsplit</a>(</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            self,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            prover_client: ProverClient,</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            mk_tree: MerkleTree,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            sender_ownership_keypair: OwnershipKeyPair,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            sender_eth_address: str,</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            sender_eth_private_key: Optional[bytes],</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            inputs: List[Tuple[int, api.ZethNote]],</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            outputs: List[Tuple[ZethAddressPub, EtherValue]],</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            v_in: EtherValue,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            v_out: EtherValue,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            tx_value: Optional[EtherValue] = <span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            compute_h_sig_cb: Optional[ComputeHSigCB] = <span class="keywordtype">None</span>) -&gt; str:</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="stringliteral">        Create and broadcast a transactions that calls the mixer with the given</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="stringliteral">        parameters. Requires a ProverClient for proof generation.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        mix_params, _ = self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a6eae7c73288ab21e0bb409133719dabd">create_mix_parameters_and_signing_key</a>(</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            prover_client,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            mk_tree,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            sender_ownership_keypair,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            sender_eth_address,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            inputs,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            outputs,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            v_in,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            v_out,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            compute_h_sig_cb)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">return</span> self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a9c65b03687b8e39c5834947a1d85258f">mix</a>(</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            mix_params,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            sender_eth_address,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            sender_eth_private_key,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            tx_value <span class="keywordflow">or</span> v_in)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a9c65b03687b8e39c5834947a1d85258f">  379</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a9c65b03687b8e39c5834947a1d85258f">mix</a>(</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            self,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            mix_params: MixParameters,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            sender_eth_address: str,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            sender_eth_private_key: Optional[bytes],</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            tx_value: EtherValue,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            call_gas: Optional[int] = <span class="keywordtype">None</span>) -&gt; str:</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="stringliteral">        Given a MixParameters object, create and broadcast a transaction</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="stringliteral">        performing the appropriate mix call.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        mixer_call = self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a7cd44f2b058e4802e816a06b1383fe50">_create_mix_call</a>(mix_params)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        tx_hash = contracts.send_contract_call(</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a5bccd48c118d72389197da2f5696aa16">web3</a>,</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            mixer_call,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            sender_eth_address,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            sender_eth_private_key,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            tx_value,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            call_gas)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">return</span> tx_hash.hex()</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a94d4a8520a1d7a3514aeba2ba82829ce">  400</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a94d4a8520a1d7a3514aeba2ba82829ce">mix_call</a>(</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            self,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            mix_params: MixParameters,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            sender_eth_address: str,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            tx_value: EtherValue,</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            call_gas: Optional[int] = <span class="keywordtype">None</span>) -&gt; bool:</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="stringliteral">        Call the mix method (executes on the RPC host without creating a</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="stringliteral">        transaction). Returns True if the call succeeds. False, otherwise.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        mixer_call = self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a7cd44f2b058e4802e816a06b1383fe50">_create_mix_call</a>(mix_params)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            contracts.local_contract_call(</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                mixer_call,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                sender_eth_address,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                tx_value,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                call_gas)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            print(<span class="stringliteral">&quot;error executing mix call:&quot;</span>)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            traceback.print_exc()</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keyword">def </span>_create_mix_call(</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            self,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            mix_parameters: MixParameters) -&gt; Any:</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="stringliteral">        Given a MixParameters object and other transaction properties, create a</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="stringliteral">        web3 call object, which can be used to create a transaction or a query.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        zksnark = <a class="code" href="namespacezeth_1_1core_1_1zksnark.html#ab85434ad85cfc14751f78186a97480bf">get_zksnark_provider</a>(self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ad00338cc15b768c7d9c3ed75fb54ebc6">prover_config</a>.zksnark_name)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        pp = self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ad00338cc15b768c7d9c3ed75fb54ebc6">prover_config</a>.pairing_parameters</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        mix_params_eth = <a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a841cba7311224ca107fac11867550484">mix_parameters_to_contract_arguments</a>(</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            zksnark, pp, mix_parameters)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">return</span> self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a72aeeee1bf0fc80ed6b206eef2e6ea5f">mixer_instance</a>.functions.mix(*mix_params_eth)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    @staticmethod</div>
<div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a3c121613213dffcad0583bcda2b540fa">  439</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a3c121613213dffcad0583bcda2b540fa">create_prover_inputs</a>(</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            mix_call_desc: MixCallDescription</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    ) -&gt; Tuple[api.ProofInputs, <a class="code" href="classzeth_1_1core_1_1signing_1_1SigningKeyPair.html">signing.SigningKeyPair</a>]:</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="stringliteral">        Given the basic parameters for a mix call, compute the input to the prover</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="stringliteral">        server, and the signing key pair.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment"># Compute Merkle paths</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        mk_tree = mix_call_desc.mk_tree</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        sender_ask = mix_call_desc.sender_ownership_keypair.a_sk</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keyword">def </span>_create_api_input(</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                input_address: int,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                input_note: api.ZethNote) -&gt; api.JoinsplitInput:</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            mk_path = <a class="code" href="namespacezeth_1_1core_1_1merkle__tree.html#adbfa311af879cd0648a597c486067889">compute_merkle_path</a>(input_address, mk_tree)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            input_nullifier = <a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a310ad56a166ee1f948976a4984aaedc1">compute_nullifier</a>(input_note, sender_ask)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#af361cfd7732c85a4cd60c74f7a728589">create_api_joinsplit_input</a>(</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                mk_path,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                input_address,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                input_note,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                sender_ask,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                input_nullifier)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        inputs = mix_call_desc.inputs</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        api_inputs = [_create_api_input(addr, note) <span class="keywordflow">for</span> addr, note <span class="keywordflow">in</span> inputs]</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        mk_root = mk_tree.get_root()</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment"># Extract (&lt;ownership-address&gt;, &lt;value&gt;) tuples</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        outputs_with_a_pk = \</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            [(zeth_addr.a_pk, <a class="code" href="namespacezeth_1_1core_1_1utils.html#a4b9406b05ff51bbe881106b0ff22a653">to_zeth_units</a>(value))</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;             <span class="keywordflow">for</span> (zeth_addr, value) <span class="keywordflow">in</span> mix_call_desc.outputs]</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="comment"># Public input and output values as Zeth units</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        public_in_value_zeth_units = <a class="code" href="namespacezeth_1_1core_1_1utils.html#a4b9406b05ff51bbe881106b0ff22a653">to_zeth_units</a>(mix_call_desc.v_in)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        public_out_value_zeth_units = <a class="code" href="namespacezeth_1_1core_1_1utils.html#a4b9406b05ff51bbe881106b0ff22a653">to_zeth_units</a>(mix_call_desc.v_out)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment"># Generate the signing key</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        signing_keypair = signing.gen_signing_keypair()</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment"># Use the specified or default h_sig computation</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        compute_h_sig_cb = mix_call_desc.compute_h_sig_cb <span class="keywordflow">or</span> compute_h_sig</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        h_sig = compute_h_sig_cb(</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            [bytes.fromhex(input.nullifier) <span class="keywordflow">for</span> input <span class="keywordflow">in</span> api_inputs],</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            signing_keypair.vk)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        phi = _phi_randomness()</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="comment"># Create the api.ZethNote objects</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        api_outputs = _create_api_zeth_notes(phi, h_sig, outputs_with_a_pk)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        proof_inputs = api.ProofInputs(</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            mk_root=mk_root.hex(),</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            js_inputs=api_inputs,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            js_outputs=api_outputs,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            pub_in_value=<a class="code" href="namespacezeth_1_1core_1_1utils.html#a2aca43966b5d21422bc3018563e44efc">int64_to_hex</a>(public_in_value_zeth_units),</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            pub_out_value=<a class="code" href="namespacezeth_1_1core_1_1utils.html#a2aca43966b5d21422bc3018563e44efc">int64_to_hex</a>(public_out_value_zeth_units),</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            h_sig=h_sig.hex(),</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            phi=phi.hex())</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">return</span> (proof_inputs, signing_keypair)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a720d1ea54819199e27ecf8e71b7f6e7b">  500</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a720d1ea54819199e27ecf8e71b7f6e7b">create_mix_parameters_from_proof</a>(</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            self,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            mix_call_desc: MixCallDescription,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            prover_inputs: api.ProofInputs,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            signing_keypair: <a class="code" href="classzeth_1_1core_1_1signing_1_1SigningKeyPair.html">signing.SigningKeyPair</a>,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            ext_proof: ExtendedProof,</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            public_data: List[int],</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            sender_eth_address: str,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            for_dispatch_call: bool = <span class="keyword">False</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    ) -&gt; MixParameters:</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="stringliteral">        Create the MixParameters from MixCallDescription, signing keypair, sender</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="stringliteral">        address and derived data (prover inputs and proof). This includes</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="stringliteral">        creating and encrypting the plaintext messages, and generating the</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="stringliteral">        one-time signature.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="stringliteral">        If for_dispatch_call is set, the parameters are to be passed to the</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="stringliteral">        Mixer&#39;s `dispatch` call in a later operation (in which proof data is</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="stringliteral">        not available), hence proof is omitted from the signature.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="comment"># Encrypt the notes</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        outputs_and_notes = zip(mix_call_desc.outputs, prover_inputs.js_outputs) \</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="comment"># pylint: disable=no-member</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        output_notes_with_k_pk: List[Tuple[api.ZethNote, EncryptionPublicKey]] = \</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            [(note, zeth_addr.k_pk)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;             <span class="keywordflow">for</span> ((zeth_addr, _), note) <span class="keywordflow">in</span> outputs_and_notes]</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        ciphertexts = <a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a31f7e94708d226553b7a9cad080e3e55">encrypt_notes</a>(output_notes_with_k_pk)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment"># Sign</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        zksnark = <a class="code" href="namespacezeth_1_1core_1_1zksnark.html#ab85434ad85cfc14751f78186a97480bf">get_zksnark_provider</a>(self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ad00338cc15b768c7d9c3ed75fb54ebc6">prover_config</a>.zksnark_name)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        signature = <a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a4ec0d78174126754fc3d93dcb83249f4">joinsplit_sign</a>(</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            zksnark,</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ad00338cc15b768c7d9c3ed75fb54ebc6">prover_config</a>.pairing_parameters,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            signing_keypair,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            sender_eth_address,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            ciphertexts,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            ext_proof,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            public_data,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            for_dispatch_call)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        mix_params = <a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html">MixParameters</a>(</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            ext_proof, public_data, signing_keypair.vk, signature, ciphertexts)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">return</span> mix_params</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a6eae7c73288ab21e0bb409133719dabd">  545</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a6eae7c73288ab21e0bb409133719dabd">create_mix_parameters_and_signing_key</a>(</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            self,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            prover_client: ProverClient,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            mk_tree: MerkleTree,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            sender_ownership_keypair: OwnershipKeyPair,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            sender_eth_address: str,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            inputs: List[Tuple[int, api.ZethNote]],</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            outputs: List[Tuple[ZethAddressPub, EtherValue]],</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            v_in: EtherValue,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            v_out: EtherValue,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            compute_h_sig_cb: Optional[ComputeHSigCB] = <span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            for_dispatch_call: bool = <span class="keyword">False</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    ) -&gt; Tuple[MixParameters, JoinsplitSigKeyPair]:</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="stringliteral">        Convenience function around creation of MixCallDescription, ProofInputs,</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="stringliteral">        Proof and MixParameters. If for_dispatch_call is set, the parameters</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">        are to be passed to the Mixer&#39;s `dispatch` call in a later operation</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral">        (in which proof data is not available), hence proof is omitted from</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">        the signature.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="comment"># Generate prover inputs and signing key</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        mix_call_desc = <a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html">MixCallDescription</a>(</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            mk_tree,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            sender_ownership_keypair,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            inputs,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            outputs,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            v_in,</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            v_out,</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            compute_h_sig_cb)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keyword">assert</span> len(mix_call_desc.inputs) == constants.JS_INPUTS</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keyword">assert</span> len(mix_call_desc.outputs) == constants.JS_OUTPUTS</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        prover_inputs, signing_keypair = MixerClient.create_prover_inputs(</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            mix_call_desc)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment"># pylint: disable=no-member</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keyword">assert</span> len(prover_inputs.js_inputs) == constants.JS_INPUTS</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keyword">assert</span> len(prover_inputs.js_outputs) == constants.JS_OUTPUTS</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment"># pylint: enable=no-member</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment"># Query the prover-server for the related proof</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        ext_proof, public_data = prover_client.get_proof(prover_inputs)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment"># Create the final MixParameters object</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        mix_params = self.<a class="code" href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a720d1ea54819199e27ecf8e71b7f6e7b">create_mix_parameters_from_proof</a>(</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            mix_call_desc,</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            prover_inputs,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            signing_keypair,</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            ext_proof,</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            public_data,</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            sender_eth_address,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            for_dispatch_call)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">return</span> mix_params, signing_keypair</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a31f7e94708d226553b7a9cad080e3e55">  601</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a31f7e94708d226553b7a9cad080e3e55">encrypt_notes</a>(</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        notes: List[Tuple[api.ZethNote, EncryptionPublicKey]]) -&gt; List[bytes]:</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="stringliteral">    Encrypts a set of output notes to be decrypted by the respective receivers.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="stringliteral">    Returns the ciphertexts corresponding to each note.</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keyword">def </span>_encrypt_note(</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            out_note: api.ZethNote, pub_key: EncryptionPublicKey) -&gt; bytes:</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        out_note_bytes = proto_utils.zeth_note_to_bytes(out_note)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacezeth_1_1core_1_1encryption.html#a8508200dbe3695c9b037c54864a22e73">encrypt</a>(out_note_bytes, pub_key)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    ciphertexts = [_encrypt_note(note, pk) <span class="keywordflow">for</span> (note, pk) <span class="keywordflow">in</span> notes]</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">return</span> ciphertexts</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a4730b5de8d77e0bdebceda15a57d06bc">  618</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a4730b5de8d77e0bdebceda15a57d06bc">receive_note</a>(</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        out_ev: MixOutputEvents,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        receiver_k_sk: EncryptionSecretKey</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;) -&gt; Optional[Tuple[bytes, api.ZethNote]]:</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="stringliteral">    Given the receivers secret key, and the event data from a transaction</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="stringliteral">    (encrypted notes), decrypt any that are intended for the receiver. Return</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="stringliteral">    tuples `(&lt;address-in-merkle-tree&gt;, ZethNote)`. Callers should record the</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="stringliteral">    address-in-merkle-tree along with ZethNote information, for convenience</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="stringliteral">    when spending the notes.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        plaintext = <a class="code" href="namespacezeth_1_1core_1_1encryption.html#ab84977a23439831b0697c8a5deee03a8">decrypt</a>(out_ev.ciphertext, receiver_k_sk)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">return</span> (</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            out_ev.commitment,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            proto_utils.zeth_note_from_bytes(plaintext))</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">except</span> InvalidSignature:</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a00d58b1fe95d4d9f596934cc3b0797b8">  640</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a00d58b1fe95d4d9f596934cc3b0797b8">get_mix_results</a>(</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        web3: Any,</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        mixer_instance: Any,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        start_block: int,</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        end_block: int,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        batch_size: Optional[int] = <span class="keywordtype">None</span>) -&gt; Iterator[MixResult]:</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="stringliteral">    Iterator for all events generated by &#39;mix&#39; executions, over some block</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="stringliteral">    range (inclusive of `end_block`). Batch eth RPC calls to avoid too many</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="stringliteral">    calls, and holding huge lists of events in memory.</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    logs = contracts.get_event_logs(</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        web3, mixer_instance, <span class="stringliteral">&quot;LogMix&quot;</span>, start_block, end_block, batch_size)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">for</span> event_data <span class="keywordflow">in</span> logs:</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">yield</span> <a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a8b35210320c24f22a60c1d56dfeeb5a6">event_args_to_mix_result</a>(event_data.args)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a4ec0d78174126754fc3d93dcb83249f4">  657</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a4ec0d78174126754fc3d93dcb83249f4">joinsplit_sign</a>(</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        zksnark: IZKSnarkProvider,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        pp: PairingParameters,</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        signing_keypair: JoinsplitSigKeyPair,</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        sender_eth_address: str,</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        ciphertexts: List[bytes],</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        extproof: ExtendedProof,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        public_data: List[int],</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        for_dispatch_call: bool = <span class="keyword">False</span>) -&gt; int:</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="stringliteral">    Generate a signature on the hash of the ciphertexts, proofs and primary</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="stringliteral">    inputs. This is used to solve transaction malleability. We chose to sign</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">    the hash and not the values themselves for modularity (to use the same code</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral">    regardless of whether GROTH16 or PGHR13 proof system is chosen), and sign</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral">    the hash of the ciphers and inputs for consistency. If for_dispatch_call is</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="stringliteral">    set, the parameters are to be passed to the Mixer&#39;s `dispatch` call in a</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="stringliteral">    later operation (in which proof data is not available), hence proof is</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="stringliteral">    omitted from the signature.</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keyword">assert</span> len(ciphertexts) == constants.JS_INPUTS</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment"># The message to sign consists of (in order):</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">#   - senders Ethereum address</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">#   - ciphertexts</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">#   - proof elements (if for_dispatch_call is False)</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">#   - public input elements</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    h = sha256()</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    h.update(<a class="code" href="namespacezeth_1_1core_1_1utils.html#ad9025f407b54820cb6a7db8298af3504">eth_address_to_bytes32</a>(sender_eth_address))</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">for</span> ciphertext <span class="keywordflow">in</span> ciphertexts:</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        h.update(ciphertext)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    proof_bytes, pub_inputs_bytes = _proof_and_inputs_to_bytes(</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        zksnark, pp, extproof, public_data)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment"># If for_dispatch_call is set, omit proof from the signature. See</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment"># AbstractMixer.sol.</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> for_dispatch_call:</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        h.update(proof_bytes)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    h.update(pub_inputs_bytes)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    message_digest = h.digest()</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">return</span> signing.sign(signing_keypair.sk, message_digest)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a192dfb8c0a97e5a4d15178eb44a3163a">  701</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a192dfb8c0a97e5a4d15178eb44a3163a">compute_commitment</a>(zeth_note: api.ZethNote, pp: PairingParameters) -&gt; bytes:</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral">    Used by the recipient of a payment to recompute the commitment and check</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral">    the membership in the tree to confirm the validity of a payment</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment"># inner_k = blake2s(r || a_pk || rho || v)</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    blake = blake2s()</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    blake.update(bytes.fromhex(zeth_note.trap_r))</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    blake.update(bytes.fromhex(zeth_note.apk))</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    blake.update(bytes.fromhex(zeth_note.rho))</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    blake.update(bytes.fromhex(zeth_note.value))</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    cm = blake.digest()</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    cm_field = int.from_bytes(cm, byteorder=<span class="stringliteral">&quot;big&quot;</span>) % pp.scalar_field_mod()</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">return</span> cm_field.to_bytes(<a class="code" href="namespacezeth_1_1cli_1_1zeth__deploy.html#ad2926a6c26d05cc927c0197ad0e9c241">int</a>(constants.DIGEST_LENGTH/8), byteorder=<span class="stringliteral">&quot;big&quot;</span>)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a310ad56a166ee1f948976a4984aaedc1">  718</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a310ad56a166ee1f948976a4984aaedc1">compute_nullifier</a>(</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        zeth_note: api.ZethNote,</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        spending_authority_ask: OwnershipSecretKey) -&gt; bytes:</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="stringliteral">    Returns nf = blake2s(1110 || [a_sk]_252 || rho)</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    binary_ask = <a class="code" href="namespacezeth_1_1core_1_1utils.html#a4dff4663bd2f21fd31d9f05aeb1752d9">digest_to_binary_string</a>(spending_authority_ask)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    first_252bits_ask = binary_ask[:252]</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    left_leg_bin = <span class="stringliteral">&quot;1110&quot;</span> + first_252bits_ask</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    left_leg = <a class="code" href="namespacezeth_1_1cli_1_1zeth__deploy.html#ad2926a6c26d05cc927c0197ad0e9c241">int</a>(left_leg_bin, 2).to_bytes(32, byteorder=<span class="stringliteral">&#39;big&#39;</span>)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    blake_hash = blake2s()</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    blake_hash.update(left_leg)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    blake_hash.update(bytes.fromhex(zeth_note.rho))</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">return</span> blake_hash.digest()</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="namespacezeth_1_1core_1_1mixer__client.html#a64f12d2446ba3749e7c04a218777513f">  734</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacezeth_1_1core_1_1mixer__client.html#a64f12d2446ba3749e7c04a218777513f">compute_h_sig</a>(</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        nullifiers: List[bytes],</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        sign_vk: JoinsplitSigVerificationKey) -&gt; bytes:</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="stringliteral">    Compute h_sig = sha256(nf_1 || ... || nf_{JS_INPUTS} || sign_vk)</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    h = sha256()</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">for</span> nf <span class="keywordflow">in</span> nullifiers:</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        h.update(nf)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    h.update(sign_vk.to_bytes())</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">return</span> h.digest()</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keyword">def </span>_create_api_zeth_notes(</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        phi: bytes,</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        hsig: bytes,</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        outputs: List[Tuple[OwnershipPublicKey, int]]</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;) -&gt; List[api.ZethNote]:</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="stringliteral">    Create ordered list of api.ZethNote objects from the output descriptions.</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keyword">def </span>_create_api_zeth_note(</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            out_index: int, recipient: OwnershipPublicKey, value: int</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    ) -&gt; api.ZethNote:</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        rho = _compute_rho_i(phi, hsig, out_index)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        trap_r = _trap_r_randomness()</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">return</span> api.ZethNote(</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            apk=<a class="code" href="namespacezeth_1_1core_1_1ownership.html#aebd2761f54eb51471a6f86b41b204801">ownership_key_as_hex</a>(recipient),</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            value=<a class="code" href="namespacezeth_1_1core_1_1utils.html#a2aca43966b5d21422bc3018563e44efc">int64_to_hex</a>(value),</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            rho=rho.hex(),</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            trap_r=trap_r)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">return</span> [</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        _create_api_zeth_note(idx, recipient, value)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">for</span> idx, (recipient, value) <span class="keywordflow">in</span> enumerate(outputs)]</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keyword">def </span>_proof_and_inputs_to_bytes(</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        snark: IZKSnarkProvider,</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        pp: PairingParameters,</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        extproof: ExtendedProof,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        public_data: List[int]) -&gt; Tuple[bytes, bytes]:</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="stringliteral">    Given a proof object, compute the byte encodings of the properties</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="stringliteral">    excluding &quot;inputs&quot;, and the byte encoding of the &quot;inputs&quot;. These are used</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="stringliteral">    when hashing the mixer call parameters for signing, so must match what</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="stringliteral">    happens in the mixer contract.</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment"># TODO: avoid duplicating this encoding to evm parameters</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    proof = extproof.proof</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">return</span> \</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <a class="code" href="namespacezeth_1_1core_1_1utils.html#a7b2cbd3f28f719641d39b60c8901b9e5">message_to_bytes</a>(snark.proof_to_contract_parameters(proof, pp)), \</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <a class="code" href="namespacezeth_1_1core_1_1utils.html#a7b2cbd3f28f719641d39b60c8901b9e5">message_to_bytes</a>(public_data)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="keyword">def </span>_trap_r_randomness() -&gt; str:</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="stringliteral">    Compute randomness `r`</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keyword">assert</span> (constants.TRAPR_LENGTH_BYTES &lt;&lt; 3) == constants.TRAPR_LENGTH</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacezeth_1_1core_1_1encryption.html#af95e3bba373ff2492b3a6f73c008b774">bytes</a>(Random.get_random_bytes(constants.TRAPR_LENGTH_BYTES)).hex()</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keyword">def </span>_compute_rho_i(phi: bytes, hsig: bytes, i: int) -&gt; bytes:</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral">    Returns</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral">      rho_i = blake2s(0 || i || 10 || phi_truncated || hsig)</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">    where i is encoded in the smallest number of bits (index_bits) required to</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">    hold values 0, ..., JS_OUTPUTS-1, and phi_truncated is binary</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="stringliteral">    representation of phi, truncated to 256 - index_bits - 3 bits.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="stringliteral">    See: Zcash protocol spec p. 57, Section 5.4.2 Pseudo Random Functions</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keyword">assert</span> i &lt; constants.JS_OUTPUTS</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment"># Compute the number of bits required to represent the input index, and</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment"># truncate phi so that:</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">#   left_leg = 0 || i || 10 || phi_truncated</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment"># occupies exactly 256 bits</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    index_bits = math.ceil(math.log(constants.JS_OUTPUTS, 2))</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    index_bin = f<span class="stringliteral">&quot;{i:b}&quot;</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    index_bin = <span class="stringliteral">&quot;0&quot;</span> * (index_bits - len(index_bin)) + index_bin</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keyword">assert</span> len(index_bin) == index_bits, \</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        f<span class="stringliteral">&quot;index_bits: {index_bits}, index_bin: {index_bin}, i: {i}&quot;</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    phi_truncated_bits = 256 - 1 - index_bits - 2</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    phi_truncated_bin = <a class="code" href="namespacezeth_1_1core_1_1utils.html#a4dff4663bd2f21fd31d9f05aeb1752d9">digest_to_binary_string</a>(phi)[:phi_truncated_bits]</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keyword">assert</span> len(phi_truncated_bin) == phi_truncated_bits</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    left_leg_bin = <span class="stringliteral">&quot;0&quot;</span> + index_bin + <span class="stringliteral">&quot;10&quot;</span> + phi_truncated_bin</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keyword">assert</span> len(left_leg_bin) == 256</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment"># Compute blake2s(left_leg || hsig)</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    blake_hash = blake2s()</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    blake_hash.update(<a class="code" href="namespacezeth_1_1cli_1_1zeth__deploy.html#ad2926a6c26d05cc927c0197ad0e9c241">int</a>(left_leg_bin, 2).to_bytes(32, byteorder=<span class="stringliteral">&#39;big&#39;</span>))</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    blake_hash.update(hsig)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">return</span> blake_hash.digest()</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="keyword">def </span>_get_dummy_rho() -&gt; str:</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keyword">assert</span> (constants.RHO_LENGTH_BYTES &lt;&lt; 3) == constants.RHO_LENGTH</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacezeth_1_1core_1_1encryption.html#af95e3bba373ff2492b3a6f73c008b774">bytes</a>(Random.get_random_bytes(constants.RHO_LENGTH_BYTES)).hex()</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="keyword">def </span>_phi_randomness() -&gt; bytes:</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="stringliteral">    Compute the transaction randomness &quot;phi&quot;, used for computing the new rhoS</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacezeth_1_1core_1_1encryption.html#af95e3bba373ff2492b3a6f73c008b774">bytes</a>(Random.get_random_bytes(constants.PHI_LENGTH_BYTES))</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_a6596fd9fdc9ad21b0e9b605e2084091e"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6596fd9fdc9ad21b0e9b605e2084091e">zeth.core.mixer_client.MixParameters.to_json_dict</a></div><div class="ttdeci">Dict[str, Any] to_json_dict(self)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00124">mixer_client.py:124</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a841cba7311224ca107fac11867550484"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a841cba7311224ca107fac11867550484">zeth.core.mixer_client.mix_parameters_to_contract_arguments</a></div><div class="ttdeci">List[Any] mix_parameters_to_contract_arguments(IZKSnarkProvider zksnark, PairingParameters pp, MixParameters mix_parameters)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00157">mixer_client.py:157</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_a6f81d7f4facbba021edd0fc46163e823"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6f81d7f4facbba021edd0fc46163e823">zeth.core.mixer_client.MixParameters.from_json</a></div><div class="ttdeci">MixParameters from_json(IZKSnarkProvider zksnark, str params_json)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00118">mixer_client.py:118</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html">zeth.core.mixer_client.MixerClient</a></div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00259">mixer_client.py:259</a></div></div>
<div class="ttc" id="anamespacetest__commands_1_1mock_html_a443e35cc54edb3a7e6f1bca433ea6234"><div class="ttname"><a href="namespacetest__commands_1_1mock.html#a443e35cc54edb3a7e6f1bca433ea6234">test_commands.mock.str</a></div><div class="ttdeci">str</div><div class="ttdef"><b>Definition:</b> <a href="mock_8py_source.html#l00018">mock.py:18</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_af361cfd7732c85a4cd60c74f7a728589"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#af361cfd7732c85a4cd60c74f7a728589">zeth.core.mixer_client.create_api_joinsplit_input</a></div><div class="ttdeci">api.JoinsplitInput create_api_joinsplit_input(List[str] merkle_path, int address, api.ZethNote note, OwnershipSecretKey a_sk, bytes nullifier)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00227">mixer_client.py:227</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a670999b239b06c8a46b55af072990892"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a670999b239b06c8a46b55af072990892">zeth.core.mixer_client.MixerClient.deploy</a></div><div class="ttdeci">Tuple[MixerClient, contracts.InstanceDescription] deploy(Any web3, ProverClient prover_client, str deployer_eth_address, Optional[bytes] deployer_eth_private_key, Optional[str] token_address=None, Optional[str] permitted_dispatcher=None, Optional[str] vk_hash=None, Optional[int] deploy_gas=None)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00273">mixer_client.py:273</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1ownership_html_aebd2761f54eb51471a6f86b41b204801"><div class="ttname"><a href="namespacezeth_1_1core_1_1ownership.html#aebd2761f54eb51471a6f86b41b204801">zeth.core.ownership.ownership_key_as_hex</a></div><div class="ttdeci">str ownership_key_as_hex(bytes a_sk)</div><div class="ttdef"><b>Definition:</b> <a href="ownership_8py_source.html#l00037">ownership.py:37</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_af990c0097315a2560d4cb9f50dc3384a"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#af990c0097315a2560d4cb9f50dc3384a">zeth.core.mixer_client.MixParameters.from_json_dict</a></div><div class="ttdeci">MixParameters from_json_dict(IZKSnarkProvider zksnark, Dict[str, Any] json_dict)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00141">mixer_client.py:141</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_ad00338cc15b768c7d9c3ed75fb54ebc6"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ad00338cc15b768c7d9c3ed75fb54ebc6">zeth.core.mixer_client.MixerClient.prover_config</a></div><div class="ttdeci">prover_config</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00265">mixer_client.py:265</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html_a00a0f359681f4860e40b2b95ed4dced6"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a00a0f359681f4860e40b2b95ed4dced6">zeth.core.mixer_client.MixCallDescription.outputs</a></div><div class="ttdeci">outputs</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00081">mixer_client.py:81</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_a9e23a5a843fee3c7d1c20f903e109c42"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a9e23a5a843fee3c7d1c20f903e109c42">zeth.core.mixer_client.MixParameters.ciphertexts</a></div><div class="ttdeci">ciphertexts</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00109">mixer_client.py:109</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html_ae72b7983fce559b439432fde63ecaa36"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#ae72b7983fce559b439432fde63ecaa36">zeth.core.mixer_client.MixCallDescription.v_in</a></div><div class="ttdeci">v_in</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00061">mixer_client.py:61</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a4730b5de8d77e0bdebceda15a57d06bc"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a4730b5de8d77e0bdebceda15a57d06bc">zeth.core.mixer_client.receive_note</a></div><div class="ttdeci">Optional[Tuple[bytes, api.ZethNote]] receive_note(MixOutputEvents out_ev, EncryptionSecretKey receiver_k_sk)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00618">mixer_client.py:618</a></div></div>
<div class="ttc" id="anamespacezeth_1_1cli_1_1zeth__deploy_html_ad2926a6c26d05cc927c0197ad0e9c241"><div class="ttname"><a href="namespacezeth_1_1cli_1_1zeth__deploy.html#ad2926a6c26d05cc927c0197ad0e9c241">zeth.cli.zeth_deploy.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="zeth__deploy_8py_source.html#l00027">zeth_deploy.py:27</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1contracts_1_1InstanceDescription_html"><div class="ttname"><a href="classzeth_1_1core_1_1contracts_1_1InstanceDescription.html">zeth.core.contracts.InstanceDescription</a></div><div class="ttdef"><b>Definition:</b> <a href="contracts_8py_source.html#l00021">contracts.py:21</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1merkle__tree_html"><div class="ttname"><a href="namespacezeth_1_1core_1_1merkle__tree.html">zeth.core.merkle_tree</a></div><div class="ttdef"><b>Definition:</b> <a href="merkle__tree_8py_source.html#l00001">merkle_tree.py:1</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a720d1ea54819199e27ecf8e71b7f6e7b"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a720d1ea54819199e27ecf8e71b7f6e7b">zeth.core.mixer_client.MixerClient.create_mix_parameters_from_proof</a></div><div class="ttdeci">MixParameters create_mix_parameters_from_proof(self, MixCallDescription mix_call_desc, api.ProofInputs prover_inputs, signing.SigningKeyPair signing_keypair, ExtendedProof ext_proof, List[int] public_data, str sender_eth_address, bool for_dispatch_call=False)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00500">mixer_client.py:500</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a5bccd48c118d72389197da2f5696aa16"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a5bccd48c118d72389197da2f5696aa16">zeth.core.mixer_client.MixerClient.web3</a></div><div class="ttdeci">web3</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00264">mixer_client.py:264</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixResult_html"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html">zeth.core.mixer_client.MixResult</a></div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00204">mixer_client.py:204</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a31f7e94708d226553b7a9cad080e3e55"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a31f7e94708d226553b7a9cad080e3e55">zeth.core.mixer_client.encrypt_notes</a></div><div class="ttdeci">List[bytes] encrypt_notes(List[Tuple[api.ZethNote, EncryptionPublicKey]] notes)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00601">mixer_client.py:601</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_ab85bfcc6e82953d3fb8dd286db6ad495"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#ab85bfcc6e82953d3fb8dd286db6ad495">zeth.core.mixer_client.MixParameters.__init__</a></div><div class="ttdeci">def __init__(self, ExtendedProof extended_proof, List[int] public_data, signing.SigningVerificationKey signature_vk, signing.Signature signature, List[bytes] ciphertexts)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00104">mixer_client.py:104</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html">zeth.core.mixer_client.MixCallDescription</a></div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00049">mixer_client.py:49</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html_a7e8968f1e53381abc40a16cc637e931b"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a7e8968f1e53381abc40a16cc637e931b">zeth.core.mixer_client.MixCallDescription.v_out</a></div><div class="ttdeci">v_out</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00062">mixer_client.py:62</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1signing_1_1SigningSecretKey_html"><div class="ttname"><a href="classzeth_1_1core_1_1signing_1_1SigningSecretKey.html">zeth.core.signing.SigningSecretKey</a></div><div class="ttdef"><b>Definition:</b> <a href="signing_8py_source.html#l00049">signing.py:49</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a90d67dc420cbfb8d34face1628ff3947"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a90d67dc420cbfb8d34face1628ff3947">zeth.core.mixer_client.get_dummy_input_and_address</a></div><div class="ttdeci">Tuple[int, api.ZethNote] get_dummy_input_and_address(OwnershipPublicKey a_pk)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00241">mixer_client.py:241</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1encryption_html"><div class="ttname"><a href="namespacezeth_1_1core_1_1encryption.html">zeth.core.encryption</a></div><div class="ttdef"><b>Definition:</b> <a href="encryption_8py_source.html#l00001">encryption.py:1</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html">zeth.core.mixer_client.MixParameters</a></div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00097">mixer_client.py:97</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1prover__client_html"><div class="ttname"><a href="namespacezeth_1_1core_1_1prover__client.html">zeth.core.prover_client</a></div><div class="ttdef"><b>Definition:</b> <a href="prover__client_8py_source.html#l00001">prover_client.py:1</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1encryption_html_af95e3bba373ff2492b3a6f73c008b774"><div class="ttname"><a href="namespacezeth_1_1core_1_1encryption.html#af95e3bba373ff2492b3a6f73c008b774">zeth.core.encryption.bytes</a></div><div class="ttdeci">bytes</div><div class="ttdef"><b>Definition:</b> <a href="encryption_8py_source.html#l00087">encryption.py:87</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a83463a7864377426e2b7b8a560254696"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a83463a7864377426e2b7b8a560254696">zeth.core.mixer_client.MixerClient.deposit</a></div><div class="ttdeci">str deposit(self, ProverClient prover_client, MerkleTree mk_tree, ZethAddress zeth_address, str sender_eth_address, Optional[bytes] sender_eth_private_key, EtherValue eth_amount, Optional[List[Tuple[ZethAddressPub, EtherValue]]] outputs=None, Optional[EtherValue] tx_value=None)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00321">mixer_client.py:321</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixOutputEvents_html"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html">zeth.core.mixer_client.MixOutputEvents</a></div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00193">mixer_client.py:193</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html_af2371c1cb4b0d0af7831baccd3e030d4"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#af2371c1cb4b0d0af7831baccd3e030d4">zeth.core.mixer_client.MixCallDescription.sender_ownership_keypair</a></div><div class="ttdeci">sender_ownership_keypair</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00060">mixer_client.py:60</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1merkle__tree_html_adbfa311af879cd0648a597c486067889"><div class="ttname"><a href="namespacezeth_1_1core_1_1merkle__tree.html#adbfa311af879cd0648a597c486067889">zeth.core.merkle_tree.compute_merkle_path</a></div><div class="ttdeci">List[str] compute_merkle_path(int address, MerkleTree mk_tree)</div><div class="ttdef"><b>Definition:</b> <a href="merkle__tree_8py_source.html#l00188">merkle_tree.py:188</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a94d4a8520a1d7a3514aeba2ba82829ce"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a94d4a8520a1d7a3514aeba2ba82829ce">zeth.core.mixer_client.MixerClient.mix_call</a></div><div class="ttdeci">bool mix_call(self, MixParameters mix_params, str sender_eth_address, EtherValue tx_value, Optional[int] call_gas=None)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00400">mixer_client.py:400</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html_a372ecca420e2d33692393900a96d7910"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a372ecca420e2d33692393900a96d7910">zeth.core.mixer_client.MixCallDescription.compute_h_sig_cb</a></div><div class="ttdeci">compute_h_sig_cb</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00063">mixer_client.py:63</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1encryption_html_a8508200dbe3695c9b037c54864a22e73"><div class="ttname"><a href="namespacezeth_1_1core_1_1encryption.html#a8508200dbe3695c9b037c54864a22e73">zeth.core.encryption.encrypt</a></div><div class="ttdeci">bytes encrypt(bytes message, EncryptionPublicKey pk_receiver)</div><div class="ttdef"><b>Definition:</b> <a href="encryption_8py_source.html#l00168">encryption.py:168</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_ad6a1c4d81bcac12afe4110bfcb97b62f"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#ad6a1c4d81bcac12afe4110bfcb97b62f">zeth.core.mixer_client.MixParameters.signature_vk</a></div><div class="ttdeci">signature_vk</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00107">mixer_client.py:107</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html_a97a1c59a2e7dc4701e40d1522b432d2d"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a97a1c59a2e7dc4701e40d1522b432d2d">zeth.core.mixer_client.MixCallDescription.inputs</a></div><div class="ttdeci">inputs</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00072">mixer_client.py:72</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a9c65b03687b8e39c5834947a1d85258f"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a9c65b03687b8e39c5834947a1d85258f">zeth.core.mixer_client.MixerClient.mix</a></div><div class="ttdeci">str mix(self, MixParameters mix_params, str sender_eth_address, Optional[bytes] sender_eth_private_key, EtherValue tx_value, Optional[int] call_gas=None)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00379">mixer_client.py:379</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixResult_html_a4b1d7f04cecfd1a0ccec5004ab0aac12"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a4b1d7f04cecfd1a0ccec5004ab0aac12">zeth.core.mixer_client.MixResult.nullifiers</a></div><div class="ttdeci">nullifiers</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00210">mixer_client.py:210</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1signing_1_1SigningKeyPair_html"><div class="ttname"><a href="classzeth_1_1core_1_1signing_1_1SigningKeyPair.html">zeth.core.signing.SigningKeyPair</a></div><div class="ttdef"><b>Definition:</b> <a href="signing_8py_source.html#l00072">signing.py:72</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a72aeeee1bf0fc80ed6b206eef2e6ea5f"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a72aeeee1bf0fc80ed6b206eef2e6ea5f">zeth.core.mixer_client.MixerClient.mixer_instance</a></div><div class="ttdeci">mixer_instance</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00266">mixer_client.py:266</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_a6bde18cd240f8a1e65248ecad0ce5e79"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a6bde18cd240f8a1e65248ecad0ce5e79">zeth.core.mixer_client.MixParameters.extended_proof</a></div><div class="ttdeci">extended_proof</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00105">mixer_client.py:105</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a6067ad5fa32f5e98e09795a605b8567a"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a6067ad5fa32f5e98e09795a605b8567a">zeth.core.mixer_client.mix_parameters_to_dispatch_parameters</a></div><div class="ttdeci">bytes mix_parameters_to_dispatch_parameters(MixParameters mix_parameters)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00176">mixer_client.py:176</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a3979cd0e3ff9c3c9ebedac2068de92df"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a3979cd0e3ff9c3c9ebedac2068de92df">zeth.core.mixer_client.MixerClient.joinsplit</a></div><div class="ttdeci">str joinsplit(self, ProverClient prover_client, MerkleTree mk_tree, OwnershipKeyPair sender_ownership_keypair, str sender_eth_address, Optional[bytes] sender_eth_private_key, List[Tuple[int, api.ZethNote]] inputs, List[Tuple[ZethAddressPub, EtherValue]] outputs, EtherValue v_in, EtherValue v_out, Optional[EtherValue] tx_value=None, Optional[ComputeHSigCB] compute_h_sig_cb=None)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00346">mixer_client.py:346</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixOutputEvents_html_a7c61bc41394303392ff22d469ce7eba8"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#a7c61bc41394303392ff22d469ce7eba8">zeth.core.mixer_client.MixOutputEvents.commitment</a></div><div class="ttdeci">commitment</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00199">mixer_client.py:199</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html_a32107594c4f7240435bb47a65b177898"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a32107594c4f7240435bb47a65b177898">zeth.core.mixer_client.MixCallDescription.mk_tree</a></div><div class="ttdeci">mk_tree</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00059">mixer_client.py:59</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixResult_html_ae02ff1b3bf86799672bd35c43a8d6b09"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#ae02ff1b3bf86799672bd35c43a8d6b09">zeth.core.mixer_client.MixResult.output_events</a></div><div class="ttdeci">output_events</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00211">mixer_client.py:211</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1zeth__address_1_1ZethAddressPub_html"><div class="ttname"><a href="classzeth_1_1core_1_1zeth__address_1_1ZethAddressPub.html">zeth.core.zeth_address.ZethAddressPub</a></div><div class="ttdef"><b>Definition:</b> <a href="zeth__address_8py_source.html#l00018">zeth_address.py:18</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a6eae7c73288ab21e0bb409133719dabd"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a6eae7c73288ab21e0bb409133719dabd">zeth.core.mixer_client.MixerClient.create_mix_parameters_and_signing_key</a></div><div class="ttdeci">Tuple[MixParameters, JoinsplitSigKeyPair] create_mix_parameters_and_signing_key(self, ProverClient prover_client, MerkleTree mk_tree, OwnershipKeyPair sender_ownership_keypair, str sender_eth_address, List[Tuple[int, api.ZethNote]] inputs, List[Tuple[ZethAddressPub, EtherValue]] outputs, EtherValue v_in, EtherValue v_out, Optional[ComputeHSigCB] compute_h_sig_cb=None, bool for_dispatch_call=False)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00545">mixer_client.py:545</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1utils_html_ad9025f407b54820cb6a7db8298af3504"><div class="ttname"><a href="namespacezeth_1_1core_1_1utils.html#ad9025f407b54820cb6a7db8298af3504">zeth.core.utils.eth_address_to_bytes32</a></div><div class="ttdeci">bytes eth_address_to_bytes32(str eth_addr)</div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00114">utils.py:114</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_a8bc3537d0f9ff59421006b7ac90a1aeb"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a8bc3537d0f9ff59421006b7ac90a1aeb">zeth.core.mixer_client.MixParameters.to_json</a></div><div class="ttdeci">str to_json(self)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00121">mixer_client.py:121</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1utils_html"><div class="ttname"><a href="namespacezeth_1_1core_1_1utils.html">zeth.core.utils</a></div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00001">utils.py:1</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixResult_html_a66dcf41a23ef1f37779a84f1aedc6a26"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a66dcf41a23ef1f37779a84f1aedc6a26">zeth.core.mixer_client.MixResult.__init__</a></div><div class="ttdeci">def __init__(self, bytes new_merkle_root, List[bytes] nullifiers, List[MixOutputEvents] output_events)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00208">mixer_client.py:208</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1pairing_html"><div class="ttname"><a href="namespacezeth_1_1core_1_1pairing.html">zeth.core.pairing</a></div><div class="ttdef"><b>Definition:</b> <a href="pairing_8py_source.html#l00001">pairing.py:1</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1utils_html_a4dff4663bd2f21fd31d9f05aeb1752d9"><div class="ttname"><a href="namespacezeth_1_1core_1_1utils.html#a4dff4663bd2f21fd31d9f05aeb1752d9">zeth.core.utils.digest_to_binary_string</a></div><div class="ttdeci">str digest_to_binary_string(bytes digest)</div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00168">utils.py:168</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a4ec0d78174126754fc3d93dcb83249f4"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a4ec0d78174126754fc3d93dcb83249f4">zeth.core.mixer_client.joinsplit_sign</a></div><div class="ttdeci">int joinsplit_sign(IZKSnarkProvider zksnark, PairingParameters pp, JoinsplitSigKeyPair signing_keypair, str sender_eth_address, List[bytes] ciphertexts, ExtendedProof extproof, List[int] public_data, bool for_dispatch_call=False)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00657">mixer_client.py:657</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a64f12d2446ba3749e7c04a218777513f"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a64f12d2446ba3749e7c04a218777513f">zeth.core.mixer_client.compute_h_sig</a></div><div class="ttdeci">bytes compute_h_sig(List[bytes] nullifiers, JoinsplitSigVerificationKey sign_vk)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00734">mixer_client.py:734</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1ownership_html"><div class="ttname"><a href="namespacezeth_1_1core_1_1ownership.html">zeth.core.ownership</a></div><div class="ttdef"><b>Definition:</b> <a href="ownership_8py_source.html#l00001">ownership.py:1</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1utils_html_a4b9406b05ff51bbe881106b0ff22a653"><div class="ttname"><a href="namespacezeth_1_1core_1_1utils.html#a4b9406b05ff51bbe881106b0ff22a653">zeth.core.utils.to_zeth_units</a></div><div class="ttdeci">int to_zeth_units(EtherValue value)</div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00220">utils.py:220</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a310ad56a166ee1f948976a4984aaedc1"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a310ad56a166ee1f948976a4984aaedc1">zeth.core.mixer_client.compute_nullifier</a></div><div class="ttdeci">bytes compute_nullifier(api.ZethNote zeth_note, OwnershipSecretKey spending_authority_ask)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00718">mixer_client.py:718</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixOutputEvents_html_aa5834603a498aa7a0b6897e7153317a4"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#aa5834603a498aa7a0b6897e7153317a4">zeth.core.mixer_client.MixOutputEvents.ciphertext</a></div><div class="ttdeci">ciphertext</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00200">mixer_client.py:200</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1utils_1_1EtherValue_html"><div class="ttname"><a href="classzeth_1_1core_1_1utils_1_1EtherValue.html">zeth.core.utils.EtherValue</a></div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00046">utils.py:46</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1utils_html_a7b2cbd3f28f719641d39b60c8901b9e5"><div class="ttname"><a href="namespacezeth_1_1core_1_1utils.html#a7b2cbd3f28f719641d39b60c8901b9e5">zeth.core.utils.message_to_bytes</a></div><div class="ttdeci">bytes message_to_bytes(Any message_list)</div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00277">utils.py:277</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1encryption_html_ab84977a23439831b0697c8a5deee03a8"><div class="ttname"><a href="namespacezeth_1_1core_1_1encryption.html#ab84977a23439831b0697c8a5deee03a8">zeth.core.encryption.decrypt</a></div><div class="ttdeci">bytes decrypt(bytes encrypted_message, EncryptionSecretKey sk_receiver)</div><div class="ttdef"><b>Definition:</b> <a href="encryption_8py_source.html#l00203">encryption.py:203</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a8b35210320c24f22a60c1d56dfeeb5a6"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a8b35210320c24f22a60c1d56dfeeb5a6">zeth.core.mixer_client.event_args_to_mix_result</a></div><div class="ttdeci">MixResult event_args_to_mix_result(Any event_args)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00218">mixer_client.py:218</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_ac1c98f79caf1029e19eb531ff905be62"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#ac1c98f79caf1029e19eb531ff905be62">zeth.core.mixer_client.MixerClient.__init__</a></div><div class="ttdeci">def __init__(self, Any web3, ProverConfiguration prover_config, Any mixer_instance)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00263">mixer_client.py:263</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_html"><div class="ttname"><a href="namespacezeth_1_1core.html">zeth.core</a></div><div class="ttdef"><b>Definition:</b> <a href="client_2zeth_2core_2____init_____8py_source.html#l00001">__init__.py:1</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a192dfb8c0a97e5a4d15178eb44a3163a"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a192dfb8c0a97e5a4d15178eb44a3163a">zeth.core.mixer_client.compute_commitment</a></div><div class="ttdeci">bytes compute_commitment(api.ZethNote zeth_note, PairingParameters pp)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00701">mixer_client.py:701</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1zksnark_html"><div class="ttname"><a href="namespacezeth_1_1core_1_1zksnark.html">zeth.core.zksnark</a></div><div class="ttdef"><b>Definition:</b> <a href="zksnark_8py_source.html#l00001">zksnark.py:1</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a7cd44f2b058e4802e816a06b1383fe50"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a7cd44f2b058e4802e816a06b1383fe50">zeth.core.mixer_client.MixerClient._create_mix_call</a></div><div class="ttdeci">Any _create_mix_call(self, MixParameters mix_parameters)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00425">mixer_client.py:425</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1zeth__address_html"><div class="ttname"><a href="namespacezeth_1_1core_1_1zeth__address.html">zeth.core.zeth_address</a></div><div class="ttdef"><b>Definition:</b> <a href="zeth__address_8py_source.html#l00001">zeth_address.py:1</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1utils_html_a4dc64205eb36fec046a8a0b491f29ee6"><div class="ttname"><a href="namespacezeth_1_1core_1_1utils.html#a4dc64205eb36fec046a8a0b491f29ee6">zeth.core.utils.get_contracts_dir</a></div><div class="ttdeci">str get_contracts_dir()</div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00255">utils.py:255</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1mixer__client_html_a00d58b1fe95d4d9f596934cc3b0797b8"><div class="ttname"><a href="namespacezeth_1_1core_1_1mixer__client.html#a00d58b1fe95d4d9f596934cc3b0797b8">zeth.core.mixer_client.get_mix_results</a></div><div class="ttdeci">Iterator[MixResult] get_mix_results(Any web3, Any mixer_instance, int start_block, int end_block, Optional[int] batch_size=None)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00640">mixer_client.py:640</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixResult_html_a5b0bfcffc4eee6492d02f78a2179b1c8"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixResult.html#a5b0bfcffc4eee6492d02f78a2179b1c8">zeth.core.mixer_client.MixResult.new_merkle_root</a></div><div class="ttdeci">new_merkle_root</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00209">mixer_client.py:209</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1encryption_html_a68eb763a92c1093dd74c6076d4c7095a"><div class="ttname"><a href="namespacezeth_1_1core_1_1encryption.html#a68eb763a92c1093dd74c6076d4c7095a">zeth.core.encryption.generate_encryption_keypair</a></div><div class="ttdeci">EncryptionKeyPair generate_encryption_keypair()</div><div class="ttdef"><b>Definition:</b> <a href="encryption_8py_source.html#l00163">encryption.py:163</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1utils_html_a2aca43966b5d21422bc3018563e44efc"><div class="ttname"><a href="namespacezeth_1_1core_1_1utils.html#a2aca43966b5d21422bc3018563e44efc">zeth.core.utils.int64_to_hex</a></div><div class="ttdeci">str int64_to_hex(int number)</div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00158">utils.py:158</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixCallDescription_html_a4a34c9c2906d533496c64fa038ab352c"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixCallDescription.html#a4a34c9c2906d533496c64fa038ab352c">zeth.core.mixer_client.MixCallDescription.__init__</a></div><div class="ttdeci">def __init__(self, MerkleTree mk_tree, OwnershipKeyPair sender_ownership_keypair, List[Tuple[int, api.ZethNote]] inputs, List[Tuple[ZethAddressPub, EtherValue]] outputs, EtherValue v_in, EtherValue v_out, Optional[ComputeHSigCB] compute_h_sig_cb=None)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00055">mixer_client.py:55</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixerClient_html_a3c121613213dffcad0583bcda2b540fa"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixerClient.html#a3c121613213dffcad0583bcda2b540fa">zeth.core.mixer_client.MixerClient.create_prover_inputs</a></div><div class="ttdeci">Tuple[api.ProofInputs, signing.SigningKeyPair] create_prover_inputs(MixCallDescription mix_call_desc)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00439">mixer_client.py:439</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1utils_html_a323360466a0b5cf1b349e5f561dfcf8a"><div class="ttname"><a href="namespacezeth_1_1core_1_1utils.html#a323360466a0b5cf1b349e5f561dfcf8a">zeth.core.utils.hex_to_uint256_list</a></div><div class="ttdeci">Iterable[int] hex_to_uint256_list(str hex_str)</div><div class="ttdef"><b>Definition:</b> <a href="core_2utils_8py_source.html#l00172">utils.py:172</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_acf3384931a1657d7487840a73621d657"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#acf3384931a1657d7487840a73621d657">zeth.core.mixer_client.MixParameters.public_data</a></div><div class="ttdeci">public_data</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00106">mixer_client.py:106</a></div></div>
<div class="ttc" id="anamespacezeth_1_1core_1_1zksnark_html_ab85434ad85cfc14751f78186a97480bf"><div class="ttname"><a href="namespacezeth_1_1core_1_1zksnark.html#ab85434ad85cfc14751f78186a97480bf">zeth.core.zksnark.get_zksnark_provider</a></div><div class="ttdeci">IZKSnarkProvider get_zksnark_provider(str zksnark_name)</div><div class="ttdef"><b>Definition:</b> <a href="zksnark_8py_source.html#l00486">zksnark.py:486</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1signing_1_1SigningVerificationKey_html"><div class="ttname"><a href="classzeth_1_1core_1_1signing_1_1SigningVerificationKey.html">zeth.core.signing.SigningVerificationKey</a></div><div class="ttdef"><b>Definition:</b> <a href="signing_8py_source.html#l00025">signing.py:25</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixOutputEvents_html_aa5f41846648c34473febadacaccf010e"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixOutputEvents.html#aa5f41846648c34473febadacaccf010e">zeth.core.mixer_client.MixOutputEvents.__init__</a></div><div class="ttdeci">def __init__(self, bytes commitment, bytes ciphertext)</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00198">mixer_client.py:198</a></div></div>
<div class="ttc" id="aclasszeth_1_1core_1_1mixer__client_1_1MixParameters_html_a5526cd2d9f1b047d336d8b31592707d6"><div class="ttname"><a href="classzeth_1_1core_1_1mixer__client_1_1MixParameters.html#a5526cd2d9f1b047d336d8b31592707d6">zeth.core.mixer_client.MixParameters.signature</a></div><div class="ttdeci">signature</div><div class="ttdef"><b>Definition:</b> <a href="mixer__client_8py_source.html#l00108">mixer_client.py:108</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 28 2022 10:29:03 for Zeth - Zerocash on Ethereum by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
